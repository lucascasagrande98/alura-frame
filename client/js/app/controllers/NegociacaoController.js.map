{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["ListaNegociacoes","Mensagem","NegociacoesView","MensagemView","NegociacaoService","DateHelper","Bind","Negociacao","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","_mensagem","_ordemAtual","_service","_init","lista","then","negociacoes","forEach","negociacao","adiciona","catch","error","texto","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","importa","apaga","esvazia","textoParaData","value","parseInt","parseFloat","focus","coluna","inverteOrdem","ordena","a","b","negociacaoController","currentInstance"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import { ListaNegociacoes } from \"../models/ListaNegociacoes\";\r\nimport { Mensagem } from \"../models/Mensagem\";\r\nimport { NegociacoesView } from \"../views/NegociacoesView\";\r\nimport { MensagemView } from \"../views/MensagemView\";\r\nimport { NegociacaoService } from \"../services/NegociacaoService\";\r\nimport { DateHelper } from \"../helpers/DateHelper\";\r\nimport { Bind } from \"../helpers/Bind\";\r\nimport { Negociacao } from \"../models/Negociacao\";\r\n\r\nclass NegociacaoController {\r\n\tconstructor() {\r\n\t\tlet $ = document.querySelector.bind(document);\r\n\t\tthis._inputData = $(\"#data\");\r\n\t\tthis._inputQuantidade = $(\"#quantidade\");\r\n\t\tthis._inputValor = $(\"#valor\");\r\n\t\tthis._listaNegociacoes = new Bind(new ListaNegociacoes(), new NegociacoesView($(\"#negociacoes-view\")), \"adiciona\", \"esvazia\", \"ordena\", \"inverteOrdem\");\r\n\t\tthis._mensagem = new Bind(new Mensagem(), new MensagemView($(\"#mensagem-view\")), \"texto\");\r\n\t\tthis._ordemAtual = \"\";\r\n\t\tthis._service = new NegociacaoService();\r\n\t\tthis._init();\r\n\t}\r\n\r\n\t_init() {\r\n\t\tthis._service\r\n\t\t\t.lista()\r\n\t\t\t.then((negociacoes) => negociacoes.forEach((negociacao) => this._listaNegociacoes.adiciona(negociacao)))\r\n\t\t\t.catch((error) => (this._mensagem.texto = error));\r\n\r\n\t\tsetInterval(() => {\r\n\t\t\tthis.importaNegociacoes();\r\n\t\t}, 3000);\r\n\t}\r\n\r\n\tadiciona(event) {\r\n\t\tevent.preventDefault();\r\n\r\n\t\tlet negociacao = this._criaNegociacao();\r\n\r\n\t\tthis._service\r\n\t\t\t.cadastra(negociacao)\r\n\t\t\t.then((mensagem) => {\r\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao);\r\n\t\t\t\tthis._mensagem.texto = mensagem;\r\n\t\t\t\tthis._limpaFormulario();\r\n\t\t\t})\r\n\t\t\t.catch((error) => (this._mensagem.texto = error));\r\n\t}\r\n\r\n\timportaNegociacoes() {\r\n\t\tthis._service\r\n\t\t\t.importa(this._listaNegociacoes.negociacoes)\r\n\t\t\t.then((negociacoes) =>\r\n\t\t\t\tnegociacoes.forEach((negociacao) => {\r\n\t\t\t\t\tthis._listaNegociacoes.adiciona(negociacao);\r\n\t\t\t\t\tthis._mensagem.texto = \"Negociações importadas com sucesso\";\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t\t.catch((error) => (this._mensagem.texto = error));\r\n\t}\r\n\r\n\tapaga() {\r\n\t\tthis._service\r\n\t\t\t.apaga()\r\n\t\t\t.then((mensagem) => {\r\n\t\t\t\tthis._mensagem.texto = mensagem;\r\n\t\t\t\tthis._listaNegociacoes.esvazia();\r\n\t\t\t})\r\n\t\t\t.catch((error) => (this._mensagem.texto = error));\r\n\t}\r\n\r\n\t_criaNegociacao() {\r\n\t\treturn new Negociacao(DateHelper.textoParaData(this._inputData.value), parseInt(this._inputQuantidade.value), parseFloat(this._inputValor.value));\r\n\t}\r\n\r\n\t_limpaFormulario() {\r\n\t\tthis._inputData.value = \"\";\r\n\t\tthis._inputQuantidade.value = 1;\r\n\t\tthis._inputValor.value = 0.0;\r\n\t\tthis._inputData.focus();\r\n\t}\r\n\r\n\tordena(coluna) {\r\n\t\tif (this._ordemAtual == coluna) {\r\n\t\t\tthis._listaNegociacoes.inverteOrdem();\r\n\t\t} else {\r\n\t\t\tthis._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\r\n\t\t}\r\n\t\tthis._ordemAtual = coluna;\r\n\t}\r\n}\r\n\r\nlet negociacaoController = new NegociacaoController();\r\nexport function currentInstance() {\r\n  return negociacaoController;\r\n}"]}