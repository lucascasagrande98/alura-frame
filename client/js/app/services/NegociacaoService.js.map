{"version":3,"sources":["../../app-es6/services/NegociacaoService.js"],"names":["HttpService","ConnectionFactory","NegociacaoDao","Negociacao","NegociacaoService","_http","get","then","negociacoes","map","objeto","Date","data","quantidade","valor","catch","erro","console","log","Error","Promise","all","obterNegociacoesDaSemana","obterNegociacoesDaSemanaAnterior","obterNegociacoesDaSemanaRetrasada","periodos","reduce","dados","periodo","concat","negociacao","getConnection","connection","dao","adiciona","error","listaTodos","apagaTodos","listaAtual","obterNegociacoes","filter","some","negociacaoExistente","JSON","stringify"],"mappings":"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","file":"NegociacaoService.js","sourcesContent":["import { HttpService } from \"./HttpService\";\r\nimport { ConnectionFactory } from \"./ConnectionFactory\";\r\nimport { NegociacaoDao } from \"../dao/NegociacaoDao\";\r\nimport { Negociacao } from \"../models/Negociacao\";\r\n\r\nexport class NegociacaoService {\r\n\tconstructor() {\r\n\t\tthis._http = new HttpService();\r\n\t}\r\n\r\n\tobterNegociacoesDaSemana() {\r\n\t\treturn this._http\r\n\t\t\t.get(\"negociacoes/semana\")\r\n\t\t\t.then((negociacoes) => {\r\n\t\t\t\treturn negociacoes.map((objeto) => new Negociacao(new Date(objeto.data), objeto.quantidade, objeto.valor));\r\n\t\t\t})\r\n\t\t\t.catch((erro) => {\r\n\t\t\t\tconsole.log(erro);\r\n\t\t\t\tthrow new Error(\"Não foi possível obter as negociações da semana!\");\r\n\t\t\t});\r\n\t}\r\n\r\n\tobterNegociacoesDaSemanaAnterior() {\r\n\t\treturn this._http\r\n\t\t\t.get(\"negociacoes/anterior\")\r\n\t\t\t.then((negociacoes) => {\r\n\t\t\t\treturn negociacoes.map((objeto) => new Negociacao(new Date(objeto.data), objeto.quantidade, objeto.valor));\r\n\t\t\t})\r\n\t\t\t.catch((erro) => {\r\n\t\t\t\tconsole.log(erro);\r\n\t\t\t\tthrow new Error(\"Não foi possível obter as negociações da semana anterior!\");\r\n\t\t\t});\r\n\t}\r\n\r\n\tobterNegociacoesDaSemanaRetrasada() {\r\n\t\treturn this._http\r\n\t\t\t.get(\"negociacoes/retrasada\")\r\n\t\t\t.then((negociacoes) => {\r\n\t\t\t\treturn negociacoes.map((objeto) => new Negociacao(new Date(objeto.data), objeto.quantidade, objeto.valor));\r\n\t\t\t})\r\n\t\t\t.catch((erro) => {\r\n\t\t\t\tconsole.log(erro);\r\n\t\t\t\tthrow new Error(\"Não foi possível obter as negociações da semana retrasada!\");\r\n\t\t\t});\r\n\t}\r\n\r\n\tobterNegociacoes() {\r\n\t\treturn Promise.all([this.obterNegociacoesDaSemana(), this.obterNegociacoesDaSemanaAnterior(), this.obterNegociacoesDaSemanaRetrasada()])\r\n\t\t\t.then((periodos) => {\r\n\t\t\t\tlet negociacoes = periodos.reduce((dados, periodo) => dados.concat(periodo), []);\r\n\t\t\t\treturn negociacoes;\r\n\t\t\t})\r\n\t\t\t.catch((erro) => {\r\n\t\t\t\tthrow new Error(erro);\r\n\t\t\t});\r\n\t}\r\n\r\n\tcadastra(negociacao) {\r\n\t\treturn ConnectionFactory.getConnection()\r\n\t\t\t.then((connection) => new NegociacaoDao(connection))\r\n\t\t\t.then((dao) => dao.adiciona(negociacao))\r\n\t\t\t.then(() => \"Negociação adicionada com sucesso\")\r\n\t\t\t.catch((error) => {\r\n\t\t\t\tconsole.log(error);\r\n\t\t\t\tthrow new Error(\"Não foi possível adicionar a negociação\");\r\n\t\t\t});\r\n\t}\r\n\r\n\tlista() {\r\n\t\treturn ConnectionFactory.getConnection()\r\n\t\t\t.then((connection) => new NegociacaoDao(connection))\r\n\t\t\t.then((dao) => dao.listaTodos())\r\n\t\t\t.catch((error) => {\r\n\t\t\t\tconsole.log(error);\r\n\t\t\t\tthrow new Error(\"Não foi possível obter as negociações\");\r\n\t\t\t});\r\n\t}\r\n\r\n\tapaga() {\r\n\t\treturn ConnectionFactory.getConnection()\r\n\t\t\t.then((connection) => new NegociacaoDao(connection))\r\n\t\t\t.then((dao) => dao.apagaTodos())\r\n\t\t\t.then(() => \"Negociações apagadas com sucesso!\")\r\n\t\t\t.catch((error) => {\r\n\t\t\t\tconsole.log(error);\r\n\t\t\t\tthrow new Error(\"Não foi possível apagar as negociações\");\r\n\t\t\t});\r\n\t}\r\n\r\n\timporta(listaAtual) {\r\n\t\treturn this.obterNegociacoes()\r\n\t\t\t.then((negociacoes) => negociacoes.filter((negociacao) => !listaAtual.some((negociacaoExistente) => JSON.stringify(negociacao) == JSON.stringify(negociacaoExistente))))\r\n\t\t\t.catch((error) => {\r\n\t\t\t\tconsole.log(error);\r\n\t\t\t\tthrow new Error(\"Não foi possível buscar negociações para importar\");\r\n\t\t\t});\r\n\t}\r\n}\r\n"]}